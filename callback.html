<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Page</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to your CSS if needed -->
</head>
<body>
    <h1>Upload Page</h1>
    <p>Here important fields are filled to integrate your game as well as payment receipt into the arcade machine system.</p>

    <!-- Directory Description and Diagram -->
    <h2>Repository Structure Description</h2>
    <p>You could make a repository of your built game directory, but make sure to match the following:</p>
    <p>Make sure to build your game for the Windows platform.</p>
    <p>The name of the repository will serve as the name of your game in the arcade machine launcher, so be sure to use capital letters if needed.</p>
    <p>The directory should include:</p>
    <ul>
        <li>The .exe file and any additional game binaries (the files generated in the build directory).</li>
        <li>The license for your game.</li>
        <li>One .gif file of your game, serving as part of your arcade machine presentation.</li>
        <li>(Optional) A folder named "Demo" including a similar Windows build and license structure for your demo version, which will be free to play (but not replay).</li>
    </ul>

    <!-- Add Repository Section -->
    <h2>Add Repository</h2>
    <p>Select your repository from the list below:</p>
    <select id="repositoryList">
        <option value="">-- Loading Repositories --</option>
    </select>

    <!-- Add Metadata to Repository Section -->
    <h2>Add Metadata to Repository</h2>
    <p>Fill in the details below to add metadata to the selected repository:</p>
    <input type="text" id="gameTitle" placeholder="Game Title" />
    <input type="text" id="gameDescription" placeholder="Game Description" />
    <input type="text" id="teamMembers" placeholder="Team Members (comma-separated)" />
    <input type="text" id="paymentInfo" placeholder="Payment Information" />
    <button onclick="addMetadata()">Add Metadata</button>

    <script>
        // Function to fetch user's repositories from GitHub
        async function fetchRepositories() {
            const token = 'YOUR_GITHUB_TOKEN'; // Replace with your GitHub token
            const url = 'https://api.github.com/user/repos';

            try {
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${token}`
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch repositories');
                }

                const repos = await response.json();
                const repoList = document.getElementById("repositoryList");

                // Clear existing options
                repoList.innerHTML = '';
                repoList.appendChild(new Option('-- Select Repository --', ''));

                // Populate dropdown with repositories
                repos.forEach(repo => {
                    const option = new Option(repo.name, repo.full_name); // repo.full_name for API operations
                    repoList.appendChild(option);
                });
            } catch (error) {
                console.error('Error fetching repositories:', error);
            }
        }

        // Call the function to fetch repositories on page load
        window.onload = fetchRepositories;

        function addMetadata() {
            const title = document.getElementById("gameTitle").value;
            const description = document.getElementById("gameDescription").value;
            const team = document.getElementById("teamMembers").value;
            const payment = document.getElementById("paymentInfo").value;

            const metadata = {
                title: title,
                description: description,
                team: team.split(',').map(member => member.trim()), // Convert string to array
                payment: payment
            };

            console.log("Metadata to be sent:", metadata);
            alert("Metadata added successfully!");
        }
    </script>

    <!-- Final Step: Upload Section -->
    <h2>(Final Step) Upload</h2>
    <p>Use the button below to upload your repository along with the metadata, and grant me access to the repository (so I can use your game repo as a submodule in the arcade machine launcher):</p>
    <button onclick="uploadRepository()">Upload to GitHub</button>

    <script>
        function uploadRepository() {
            console.log("Uploading repository...");
            alert("Repository uploaded successfully!"); // Placeholder for feedback
        }
    </script>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Project Callback Page</p>
    </footer>
</body>
</html>
